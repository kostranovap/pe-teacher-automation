<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ student.full_name }} - –ü—Ä–æ—Ñ–∏–ª—å –¥–ª—è –ø–µ—á–∞—Ç–∏</title>
    <style>
        @media print {
            body { margin: 0; padding: 20px; }
            .no-print { display: none; }
            .page-break { page-break-after: always; }
        }
        
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 210mm;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1, h2, h3 { color: #2c3e50; }
        h1 { border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { border-bottom: 2px solid #95a5a6; padding-bottom: 5px; margin-top: 30px; }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .info-item {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .info-label {
            font-weight: bold;
            color: #7f8c8d;
        }
        
        .rating-box {
            text-align: center;
            padding: 20px;
            border: 3px solid #3498db;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .rating-value {
            font-size: 48px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .rating-grade {
            font-size: 24px;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 5px;
            display: inline-block;
            margin-top: 10px;
        }
        
        .grade-excellent { background: #27ae60; color: white; }
        .grade-good { background: #3498db; color: white; }
        .grade-satisfactory { background: #f39c12; color: white; }
        .grade-fail { background: #e74c3c; color: white; }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        .components-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .component-box {
            text-align: center;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
        
        .component-value {
            font-size: 32px;
            font-weight: bold;
            color: #3498db;
        }
        
        .component-label {
            color: #7f8c8d;
            font-size: 14px;
        }
        
        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
            text-align: center;
            color: #7f8c8d;
        }
        
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .print-button:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <button onclick="window.print()" class="print-button no-print">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
    
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="header">
        <h1>–ü–†–û–§–ò–õ–¨ –°–¢–£–î–ï–ù–¢–ê</h1>
        <p style="font-size: 18px; color: #7f8c8d;">–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∫—É–ª—å—Ç—É—Ä—ã</p>
        <p style="font-size: 14px; color: #95a5a6;">–î–∞—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è: {{ now.strftime('%d.%m.%Y %H:%M') }}</p>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <h2>–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>
    <div class="info-grid">
        <div class="info-item">
            <div class="info-label">–§–ò–û:</div>
            <div>{{ student.full_name }}</div>
        </div>
        <div class="info-item">
            <div class="info-label">–ù–æ–º–µ—Ä —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ:</div>
            <div>{{ student.student_number }}</div>
        </div>
        <div class="info-item">
            <div class="info-label">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</div>
            <div>{{ student.birth_date.strftime('%d.%m.%Y') }}</div>
        </div>
        <div class="info-item">
            <div class="info-label">–ü–æ–ª:</div>
            <div>{{ '–ú—É–∂—Å–∫–æ–π' if student.gender == 'M' else '–ñ–µ–Ω—Å–∫–∏–π' }}</div>
        </div>
        <div class="info-item">
            <div class="info-label">–ì—Ä—É–ø–ø–∞:</div>
            <div>{{ student.group.name }}</div>
        </div>
        <div class="info-item">
            <div class="info-label">–ö—É—Ä—Å / –°–µ–º–µ—Å—Ç—Ä:</div>
            <div>{{ student.group.course }} / {{ student.group.semester }}</div>
        </div>
        <div class="info-item">
            <div class="info-label">–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å:</div>
            <div>{{ student.group.specialty.name }}</div>
        </div>
        <div class="info-item">
            <div class="info-label">–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –≥—Ä—É–ø–ø–∞:</div>
            <div>{{ student.medical_group|capitalize }}</div>
        </div>
    </div>

    <!-- –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–π—Ç–∏–Ω–≥ -->
    <h2>–ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–π—Ç–∏–Ω–≥</h2>
    <div class="rating-box">
        <div class="rating-value">{{ rating.total }}</div>
        <div style="color: #7f8c8d; font-size: 18px;">–∏–∑ 100 –±–∞–ª–ª–æ–≤</div>
        <div class="rating-grade grade-{{ 'excellent' if rating.grade == '–û—Ç–ª–∏—á–Ω–æ' else ('good' if rating.grade == '–•–æ—Ä–æ—à–æ' else ('satisfactory' if rating.grade == '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ' else 'fail')) }}">
            {{ rating.grade }}
        </div>
        <div style="margin-top: 15px; font-size: 18px;">
            {{ '–ó–ê–ß–Å–¢ –ü–û–õ–£–ß–ï–ù ‚úì' if rating.passed else '–ó–ê–ß–Å–¢ –ù–ï –ü–û–õ–£–ß–ï–ù ‚úó' }}
        </div>
    </div>

    <!-- –†–∞–∑–±–∏–≤–∫–∞ –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º -->
    <h2>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–π—Ç–∏–Ω–≥–∞</h2>
    <div class="components-grid">
        <div class="component-box">
            <div class="component-value">{{ rating.attendance }}</div>
            <div class="component-label">–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å<br>(–∏–∑ 30)</div>
        </div>
        <div class="component-box">
            <div class="component-value">{{ rating.module1 }}</div>
            <div class="component-label">–ú–æ–¥—É–ª—å 1<br>(–∏–∑ 35)</div>
        </div>
        <div class="component-box">
            <div class="component-value">{{ rating.module2 }}</div>
            <div class="component-label">–ú–æ–¥—É–ª—å 2<br>(–∏–∑ 35)</div>
        </div>
        <div class="component-box">
            <div class="component-value">+{{ rating.bonus }}</div>
            <div class="component-label">–ë–æ–Ω—É—Å–Ω—ã–µ<br>–±–∞–ª–ª—ã</div>
        </div>
    </div>

    <!-- –ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å -->
    <h2>–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</h2>
    <p><strong>–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏:</strong> {{ attendance_pct }}%</p>

    <div class="page-break"></div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤ -->
    <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤</h2>
    {% if results_by_theme %}
        {% for theme_name, theme_results in results_by_theme.items() %}
        <h3>{{ theme_name }}</h3>
        <table>
            <thead>
                <tr>
                    <th>–ù–æ—Ä–º–∞—Ç–∏–≤</th>
                    <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                    <th>–ë–∞–ª–ª—ã</th>
                    <th>–î–∞—Ç–∞</th>
                </tr>
            </thead>
            <tbody>
                {% for result in theme_results %}
                <tr>
                    <td>{{ result.standard.name }}</td>
                    <td><strong>{{ result.result_value }}</strong> {{ result.standard.unit }}</td>
                    <td>{{ result.points }} –∏–∑ 5</td>
                    <td>{{ result.date.strftime('%d.%m.%Y') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endfor %}
    {% else %}
    <p style="text-align: center; color: #7f8c8d; padding: 20px;">–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤</p>
    {% endif %}

    <!-- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è -->
    <h2>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h2>
    {% if assignments %}
    <table>
        <thead>
            <tr>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th>–¢–∏–ø</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–î–µ–¥–ª–∞–π–Ω</th>
                <th>–ë–∞–ª–ª—ã</th>
            </tr>
        </thead>
        <tbody>
            {% for assignment in assignments %}
            <tr>
                <td>{{ assignment.title }}</td>
                <td>{{ assignment.type|capitalize }}</td>
                <td>{{ assignment.status|capitalize }}</td>
                <td>{{ assignment.deadline.strftime('%d.%m.%Y') }}</td>
                <td>+{{ assignment.bonus_points }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="text-align: center; color: #7f8c8d; padding: 20px;">–ù–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π</p>
    {% endif %}

    <!-- –§—É—Ç–µ—Ä -->
    <div class="footer">
        <p>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∫—É–ª—å—Ç—É—Ä—ã</p>
        <p>–î–æ–∫—É–º–µ–Ω—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ {{ now.strftime('%d.%m.%Y –≤ %H:%M') }}</p>
    </div>
</body>
</html>